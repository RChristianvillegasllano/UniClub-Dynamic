<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="icon" href="https://phshirt.com/wp-content/uploads/2022/01/UM-Tagum-College-1950.png" type="image/x-icon">
  <title>Officer Sign Up • UniClub Management</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brandRed: '#c62828',
            brandOrange: '#ef6c00',
            ink: '#1f2933',
            subtle: '#6b7280',
          },
          fontFamily: {
            ui: ['Inter', 'system-ui', 'sans-serif'],
          },
        }
      }
    }
  </script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
    
    body {
      background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
      min-height: 100vh;
    }

    body::before {
      content: "";
      position: fixed;
      inset: 0;
      background: url("/img/sunstar_import_uploads_images_2023_07_05_446503.avif") center/cover no-repeat;
      background-attachment: fixed;
      filter: saturate(0.7) brightness(0.8);
      z-index: -2;
    }
    body::after {
      content: "";
      position: fixed;
      inset: 0;
      background: linear-gradient(135deg, #801515 0%, #d75a06 100%);
      mix-blend-mode: multiply;
      z-index: -1;
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(32px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(24px); }
      to { opacity: 1; transform: translateX(0); }
    }

    .fade-up { animation: fadeUp 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
    .slide-in { animation: slideIn 0.7s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
    
    .glass-card {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      box-shadow: 0 20px 60px rgba(0,0,0,0.3), 0 0 0 1px rgba(255,255,255,0.9);
    }

    .input-field {
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.3);
      transition: all 0.3s ease;
      color: #1f2933;
    }
    
    .input-field::placeholder {
      color: #64748b;
    }
    
    .input-field:focus {
      background: rgba(255, 255, 255, 1);
      border-color: #c62828;
      box-shadow: 0 0 0 3px rgba(198, 40, 40, 0.2);
      outline: none;
    }

    .btn-officer {
      background: linear-gradient(135deg, #801515 0%, #d75a06 100%);
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px rgba(198, 40, 40, 0.4);
      position: relative;
      overflow: hidden;
    }

    .btn-officer::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 0;
      height: 0;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.2);
      transform: translate(-50%, -50%);
      transition: width 0.6s, height 0.6s;
    }

    .btn-officer:hover::after {
      width: 300px;
      height: 300px;
    }
    
    .btn-officer:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 30px rgba(198, 40, 40, 0.6);
    }
    
    .btn-officer:active {
      transform: translateY(0);
    }

    .alert-error {
      background: linear-gradient(135deg, rgba(239, 68, 68, 0.15) 0%, rgba(220, 38, 38, 0.15) 100%);
      border-left: 3px solid #ef4444;
    }
  </style>
</head>

<body class="min-h-screen font-ui text-white flex items-center justify-center px-4 py-8" style="overflow-y: auto;">
  <main class="w-full max-w-7xl">
    
    <!-- Top Bar -->
    <header class="fade-up mb-12 flex items-center justify-between">
      <div class="flex items-center gap-4">
        <div class="w-14 h-14 flex items-center justify-center p-2">
          <img src="/img/logo.png" alt="UniClub Logo" class="w-full h-full object-contain">
        </div>
        <div>
          <p class="text-xs uppercase tracking-[0.3em] text-white/80 font-semibold mb-1">Officer Registration</p>
          <h1 class="text-2xl font-bold text-white">UniClub Management</h1>
        </div>
      </div>
    </header>

    <!-- Main Content -->
    <div class="grid lg:grid-cols-[1fr,1.3fr] gap-16 items-start">
      
      <!-- Left Side - Information -->
      <div class="fade-in-up space-y-8 lg:sticky lg:top-8" style="animation-delay: 0.1s;">
        
        <!-- Main Heading -->
        <div class="space-y-5">
          <div class="inline-block px-4 py-2 rounded-full bg-white/10 backdrop-blur-md border border-white/20">
            <p class="text-xs uppercase tracking-[0.2em] text-white/90 font-medium">
              Officer Registration
            </p>
          </div>
          
          <h1 class="text-4xl lg:text-5xl font-bold leading-tight">
            Create your<br/>
            <span class="bg-gradient-to-r from-white to-white/90 bg-clip-text text-transparent">Officer</span> account
          </h1>
          
          <p class="text-lg text-white/90 leading-relaxed max-w-xl">
            Register to become an officer and manage your organization's activities, events, and members at University of Mindanao.
          </p>
        </div>

        <!-- Benefits -->
        <div class="space-y-4 pt-4">
          <div class="flex items-start gap-3">
            <div class="w-6 h-6 rounded-lg bg-white/20 flex items-center justify-center flex-shrink-0 mt-0.5">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
            </div>
            <div>
              <p class="font-semibold mb-1">Member Management</p>
              <p class="text-sm text-white/80">Full control over memberships and roles</p>
            </div>
          </div>
          
          <div class="flex items-start gap-3">
            <div class="w-6 h-6 rounded-lg bg-white/20 flex items-center justify-center flex-shrink-0 mt-0.5">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
            </div>
            <div>
              <p class="font-semibold mb-1">Event Creation</p>
              <p class="text-sm text-white/80">Create and manage campus events</p>
            </div>
          </div>
          
          <div class="flex items-start gap-3">
            <div class="w-6 h-6 rounded-lg bg-white/20 flex items-center justify-center flex-shrink-0 mt-0.5">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
            </div>
            <div>
              <p class="font-semibold mb-1">Advanced Analytics</p>
              <p class="text-sm text-white/80">Real-time insights and reporting tools</p>
            </div>
          </div>
        </div>

        <!-- Support -->
        <div class="pt-4">
          <p class="text-xs text-white/60">
            Need help? Contact IT Support at <span class="text-white/90">support@umindanao.edu.ph</span>
          </p>
        </div>
      </div>

      <!-- Right Side - Sign Up Form -->
      <div class="flex justify-end slide-in" style="animation-delay: 0.2s;">
        <div class="glass-card w-full max-w-3xl rounded-3xl p-8 lg:p-10">
          
          <!-- Form Header -->
          <div class="text-center mb-8">
            <div class="w-16 h-16 mx-auto mb-4 flex items-center justify-center p-3">
              <img src="/img/logo.png" alt="UniClub Logo" class="w-full h-full object-contain">
            </div>
            <h3 class="text-2xl font-bold text-gray-800 mb-2">Create Officer Account</h3>
            <p class="text-gray-600 text-sm">
              Fill in your details to get started
            </p>
          </div>

          <!-- Success Alert -->
          <% if (typeof success !== 'undefined' && success === 'pending') { %>
            <div class="rounded-xl p-4 mb-6 bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-200">
              <div class="flex items-start gap-3">
                <svg class="w-5 h-5 text-green-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                </svg>
                <div>
                  <p class="font-semibold text-green-800 text-sm mb-1">Registration Successful!</p>
                  <p class="text-green-700 text-sm">Your account has been submitted for admin approval. You will be able to log in once an administrator approves your request.</p>
                </div>
              </div>
            </div>
          <% } %>

          <!-- Error Alert -->
          <% if (typeof error !== 'undefined' && error) { %>
            <div class="alert-error rounded-xl p-4 mb-6">
              <div class="flex items-start gap-3">
                <svg class="w-5 h-5 text-red-600 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                </svg>
                <div>
                  <p class="font-semibold text-red-800 text-sm mb-1">Registration Failed</p>
                  <p class="text-red-700 text-sm"><%= error %></p>
                </div>
              </div>
            </div>
          <% } %>

          <!-- Sign Up Form -->
          <form action="/officer/signup" method="POST" class="space-y-6" id="signupForm">
            <input type="hidden" name="_csrf" value="<%= csrfToken %>">
            <!-- Personal Information -->
            <div class="space-y-5">
              <h3 class="text-sm font-semibold text-gray-800 uppercase tracking-wide">Personal Information</h3>
              
              <!-- Names Row -->
              <div class="grid md:grid-cols-2 gap-4">
                <div>
                  <label class="block text-sm font-bold text-gray-800 mb-2">
                    First Name <span class="text-brandRed">*</span>
                  </label>
                  <input
                    type="text"
                    name="first_name"
                    id="firstName"
                    required
                    placeholder="Enter your first name"
                    title="Only letters, spaces, hyphens, and apostrophes are allowed"
                    oninput="filterNameInput('firstName', 'firstNameError')"
                    onkeypress="preventNumbers(event)"
                    class="input-field w-full px-4 py-3.5 text-sm rounded-xl border-2 border-gray-200 focus:border-brandRed"
                  />
                  <p id="firstNameError" class="text-xs text-red-600 mt-1" style="display: none;"></p>
                </div>
                <div>
                  <label class="block text-sm font-bold text-gray-800 mb-2">
                    Last Name <span class="text-brandRed">*</span>
                  </label>
                  <input
                    type="text"
                    name="last_name"
                    id="lastName"
                    required
                    placeholder="Enter your last name"
                    title="Only letters, spaces, hyphens, and apostrophes are allowed"
                    oninput="filterNameInput('lastName', 'lastNameError')"
                    onkeypress="preventNumbers(event)"
                    class="input-field w-full px-4 py-3.5 text-sm rounded-xl border-2 border-gray-200 focus:border-brandRed"
                  />
                  <p id="lastNameError" class="text-xs text-red-600 mt-1" style="display: none;"></p>
                </div>
              </div>

              <!-- Student ID -->
              <div>
                <label class="block text-sm font-bold text-gray-800 mb-2">
                  Student ID <span class="text-brandRed">*</span>
                </label>
                <input
                  type="text"
                  name="studentid"
                  id="studentId"
                  required
                  pattern="[0-9]{6}"
                  maxlength="6"
                  placeholder="Enter your student ID"
                  oninput="validateStudentId()"
                  onkeypress="preventLettersInStudentId(event)"
                  class="input-field w-full px-4 py-3.5 text-sm rounded-xl border-2 border-gray-200 focus:border-brandRed"
                />
                <p class="text-xs text-gray-500 mt-1">Must be exactly 6 digits</p>
                <p id="studentIdError" class="text-xs text-red-600 mt-1 hidden"></p>
              </div>

              <!-- Department & Program -->
              <div data-dept-program>
                <!-- Department -->
                <div>
                  <label class="block text-sm font-bold text-gray-800 mb-2">
                    Department <span class="text-brandRed">*</span>
                  </label>
                  <select name="department" id="department" data-dept-select required
                    class="input-field w-full px-4 py-3.5 text-sm rounded-xl border-2 border-gray-200 focus:border-brandRed">
                    <option value="">Select Department</option>
                    <option value="Department of Accounting Education">Department of Accounting Education</option>
                    <option value="Department of Arts and Sciences Education">Department of Arts and Sciences Education</option>
                    <option value="Department of Business Administration Education">Department of Business Administration Education</option>
                    <option value="Department of Computing Education">Department of Computing Education</option>
                    <option value="Department of Criminal Justice Education">Department of Criminal Justice Education</option>
                    <option value="Department of Engineering Education">Department of Engineering Education</option>
                    <option value="Department of Hospitality Education">Department of Hospitality Education</option>
                    <option value="Department of Teacher Education">Department of Teacher Education</option>
                  </select>
                  <p class="text-xs text-gray-500 mt-1">Select your department</p>
                  <p id="departmentError" class="text-xs text-red-600 mt-1 hidden"></p>
                </div>

                <!-- Programs (shown when department is selected) -->
                <div id="programsSection" class="mt-4">
                  <label class="block text-sm font-bold text-gray-800 mb-2">
                    Program <span class="text-brandRed">*</span>
                  </label>
                  <select name="program" id="programSelect" data-program-select required
                    class="input-field w-full px-4 py-3.5 text-sm rounded-xl border-2 border-gray-200 focus:border-brandRed">
                    <option value="">Select Department First</option>
                  </select>
                  <p class="text-xs text-gray-500 mt-1">Select your program from the department</p>
                  <p id="programError" class="text-xs text-red-600 mt-1 hidden"></p>
                </div>
              </div>

              <!-- Club/Organization -->
              <div>
                <label class="block text-sm font-bold text-gray-800 mb-2">
                  Club/Organization <span class="text-brandRed">*</span>
                </label>
                <select name="club_id" id="club_id" required
                  class="input-field w-full px-4 py-3.5 text-sm rounded-xl border-2 border-gray-200 focus:border-brandRed">
                  <option value="">Select Club/Organization</option>
                  <% if (typeof clubs !== 'undefined' && clubs && Array.isArray(clubs) && clubs.length > 0) { %>
                    <% clubs.forEach(function(club) { %>
                      <option value="<%= club.id %>"><%= club.name || 'Unnamed Club' %></option>
                    <% }); %>
                  <% } else { %>
                    <option value="" disabled>No clubs available - Please contact admin</option>
                    <!-- DEBUG INFO (remove in production) -->
                    <!-- Clubs type: <%= typeof clubs %>, Is Array: <%= Array.isArray(clubs) %>, Length: <%= clubs && clubs.length ? clubs.length : 'N/A' %> -->
                  <% } %>
                </select>
                <p class="text-xs text-gray-500 mt-1">Select the club or organization you belong to</p>
                <% if (typeof clubs === 'undefined' || !clubs || !Array.isArray(clubs) || clubs.length === 0) { %>
                  <p class="text-xs text-amber-600 mt-1 font-semibold">⚠️ No clubs found. Please ensure clubs are created in the admin panel first.</p>
                <% } %>
                <p id="clubIdError" class="text-xs text-red-600 mt-1 hidden"></p>
              </div>

              <!-- Position/Role -->
              <div>
                <label class="block text-sm font-bold text-gray-800 mb-2">
                  Position/Role <span class="text-brandRed">*</span>
                </label>
                <select name="role" id="role" required
                  class="input-field w-full px-4 py-3.5 text-sm rounded-xl border-2 border-gray-200 focus:border-brandRed">
                  <option value="">Select Position</option>
                  <option value="President">President</option>
                  <option value="Vice President">Vice President</option>
                  <option value="Secretary">Secretary</option>
                  <option value="Treasurer">Treasurer</option>
                  <option value="Auditor">Auditor</option>
                  <option value="Public Relations Officer">Public Relations Officer</option>
                  <option value="Events Coordinator">Events Coordinator</option>
                  <option value="Committee Head">Committee Head</option>
                  <option value="Other">Other</option>
                </select>
                <p class="text-xs text-gray-500 mt-1">Select your position in the organization</p>
                <p id="roleError" class="text-xs text-red-600 mt-1 hidden"></p>
              </div>
            </div>

            <!-- Account Information -->
            <div class="space-y-5 pt-4 border-t border-gray-200">
              <h3 class="text-sm font-semibold text-gray-800 uppercase tracking-wide">Account Information</h3>
              
              <!-- Email (UMindanao Email) -->
              <div>
                <label class="block text-sm font-bold text-gray-800 mb-2">
                  UMindanao Email <span class="text-brandRed">*</span>
                </label>
                <input
                  type="email"
                  name="email"
                  id="email"
                  required
                  placeholder="Enter your UMindanao email"
                  oninput="validateEmail()"
                  onblur="validateEmail()"
                  class="input-field w-full px-4 py-3.5 text-sm rounded-xl border-2 border-gray-200 focus:border-brandRed"
                />
                <p class="text-xs text-gray-500 mt-1">Enter your UMindanao email address (e.g., j.delacruz.111222.tc@umindanao.edu.ph)</p>
                <p id="emailError" class="text-xs text-red-600 mt-1" style="display: none;"></p>
              </div>

              <!-- Password -->
              <div>
                <label class="block text-sm font-bold text-gray-800 mb-2">
                  Password <span class="text-brandRed">*</span>
                </label>
                <div class="relative">
                  <input
                    type="password"
                    name="password"
                    id="password"
                    required
                    placeholder="Create a password"
                    minlength="6"
                    oninput="validatePassword()"
                    class="input-field w-full px-4 py-3.5 pr-12 text-sm rounded-xl border-2 border-gray-200 focus:border-brandRed"
                  />
                  <button
                    type="button"
                    id="togglePasswordBtn"
                    class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-brandRed transition-colors z-10 focus:outline-none"
                    aria-label="Toggle password visibility"
                  >
                    <svg id="eyeIcon" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                    </svg>
                    <svg id="eyeOffIcon" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/>
                    </svg>
                  </button>
                </div>
                <p class="text-xs text-gray-500 mt-1">Must be at least 6 characters</p>
                <p id="passwordError" class="text-xs text-red-600 mt-1 hidden"></p>
              </div>

              <!-- Confirm Password -->
              <div>
                <label class="block text-sm font-bold text-gray-800 mb-2">
                  Confirm Password <span class="text-brandRed">*</span>
                </label>
                <div class="relative">
                  <input
                    type="password"
                    name="confirmPassword"
                    id="confirmPassword"
                    required
                    placeholder="Confirm your password"
                    minlength="6"
                    oninput="validatePasswordMatch()"
                    class="input-field w-full px-4 py-3.5 pr-12 text-sm rounded-xl border-2 border-gray-200 focus:border-brandRed"
                  />
                  <button
                    type="button"
                    id="toggleConfirmPasswordBtn"
                    class="absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 hover:text-brandRed transition-colors z-10 focus:outline-none"
                    aria-label="Toggle confirm password visibility"
                  >
                    <svg id="eyeIconConfirm" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/>
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"/>
                    </svg>
                    <svg id="eyeOffIconConfirm" class="w-5 h-5 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"/>
                    </svg>
                  </button>
                </div>
                <p id="confirmPasswordError" class="text-xs text-red-600 mt-1 hidden"></p>
              </div>
            </div>

            <!-- Terms and Conditions -->
            <div class="flex items-start gap-3 pt-2">
              <input
                type="checkbox"
                name="terms"
                id="terms"
                required
                class="mt-1 w-4 h-4 text-brandRed border-gray-300 rounded focus:ring-brandRed focus:ring-2"
              />
              <label for="terms" class="text-sm text-gray-700 cursor-pointer">
                I agree to the 
                <a href="#" class="text-brandRed hover:text-brandOrange underline font-semibold" onclick="event.preventDefault(); openTermsModal(); return false;">
                  Terms and Conditions
                </a>
                <span class="text-brandRed">*</span>
              </label>
            </div>
            <p id="termsError" class="text-xs text-red-600 mt-1 hidden"></p>

            <!-- Submit Button -->
            <button
              type="submit"
              class="btn-officer w-full py-4 text-base font-bold tracking-wide rounded-xl text-white uppercase relative z-10"
            >
              Create Account
            </button>
          </form>

          <!-- Sign In Link -->
          <div class="mt-6 text-center">
            <p class="text-sm text-gray-600">
              Already have an account? 
              <a href="/officer/login" class="font-semibold text-brandRed hover:text-brandOrange transition-colors">
                Sign in here
              </a>
            </p>
          </div>

          <!-- Footer -->
          <div class="mt-8 pt-6 border-t border-gray-200">
            <div class="text-center space-y-2">
              <p class="text-sm font-semibold text-gray-700">
                UniClub Management System
              </p>
              <p class="text-xs text-gray-500">
                Officer Portal • University of Mindanao
              </p>
              <p class="text-xs text-gray-400 mt-2">
                &copy; <span id="currentYear">2024</span> All Rights Reserved
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Set current year
    document.getElementById('currentYear').textContent = new Date().getFullYear();

    // Initialize password toggle buttons when DOM is ready
    (function() {
      function initPasswordToggles() {
        // Password toggle
        const passwordToggle = document.getElementById('togglePasswordBtn');
        if (passwordToggle) {
          passwordToggle.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            togglePassword(e);
            return false;
          });
        }
        
        // Confirm password toggle
        const confirmPasswordToggle = document.getElementById('toggleConfirmPasswordBtn');
        if (confirmPasswordToggle) {
          confirmPasswordToggle.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            toggleConfirmPassword(e);
            return false;
          });
        }
      }
      
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initPasswordToggles);
      } else {
        initPasswordToggles();
      }
    })();

    function togglePassword(event) {
      if (event) {
        event.preventDefault();
        event.stopPropagation();
      }
      const input = document.getElementById('password');
      const eyeIcon = document.getElementById('eyeIcon');
      const eyeOffIcon = document.getElementById('eyeOffIcon');
      
      if (!input || !eyeIcon || !eyeOffIcon) {
        console.error('Password toggle elements not found');
        return;
      }
      
      if (input.type === 'password') {
        input.type = 'text';
        eyeIcon.classList.add('hidden');
        eyeOffIcon.classList.remove('hidden');
      } else {
        input.type = 'password';
        eyeIcon.classList.remove('hidden');
        eyeOffIcon.classList.add('hidden');
      }
    }

    function toggleConfirmPassword(event) {
      if (event) {
        event.preventDefault();
        event.stopPropagation();
      }
      const input = document.getElementById('confirmPassword');
      const eyeIcon = document.getElementById('eyeIconConfirm');
      const eyeOffIcon = document.getElementById('eyeOffIconConfirm');
      
      if (!input || !eyeIcon || !eyeOffIcon) {
        console.error('Confirm password toggle elements not found');
        return;
      }
      
      if (input.type === 'password') {
        input.type = 'text';
        eyeIcon.classList.add('hidden');
        eyeOffIcon.classList.remove('hidden');
      } else {
        input.type = 'password';
        eyeIcon.classList.remove('hidden');
        eyeOffIcon.classList.add('hidden');
      }
    }

    // Prevent numbers from being typed in name fields
    function preventNumbers(event) {
      const char = String.fromCharCode(event.which || event.keyCode);
      // Block numbers specifically
      if (/[0-9]/.test(char)) {
        event.preventDefault();
        const input = event.target;
        // Get error element - handle both firstName/firstNameError and lastName/lastNameError
        let errorElementId = input.id + 'Error';
        if (input.id === 'firstName') {
          errorElementId = 'firstNameError';
        } else if (input.id === 'lastName') {
          errorElementId = 'lastNameError';
        }
        const errorElement = document.getElementById(errorElementId);
        if (errorElement) {
          errorElement.textContent = 'Numbers are not allowed in names';
          errorElement.style.display = 'block';
          input.classList.add('border-red-500');
          input.classList.remove('border-gray-200');
          // Clear error after 3 seconds
          setTimeout(() => {
            if (errorElement && errorElement.textContent === 'Numbers are not allowed in names') {
              // Only hide if input is now valid
              const currentValue = input.value;
              if (!/[0-9]/.test(currentValue) && /^[a-zA-Z\s'-]*$/.test(currentValue)) {
                errorElement.style.display = 'none';
                input.classList.remove('border-red-500');
                input.classList.add('border-gray-200');
              }
            }
          }, 3000);
        }
        return false;
      }
      // Allow: letters, spaces, hyphens, apostrophes, backspace, delete, tab, escape, enter, arrow keys
      if (/[a-zA-Z\s'-]/.test(char) || 
          event.keyCode === 8 || event.keyCode === 46 || event.keyCode === 9 || 
          event.keyCode === 27 || event.keyCode === 13 || 
          (event.keyCode >= 37 && event.keyCode <= 40)) {
        return true;
      }
      // Block other special characters
      event.preventDefault();
      return false;
    }

    // Filter name input and validate in real-time
    function filterNameInput(inputId, errorId) {
      const input = document.getElementById(inputId);
      const errorElement = document.getElementById(errorId);
      
      if (!input || !errorElement) {
        console.error('Input or error element not found:', inputId, errorId);
        return false;
      }
      
      // Remove any numbers that might have been pasted
      const originalValue = input.value;
      const filteredValue = originalValue.replace(/[0-9]/g, '');
      
      if (originalValue !== filteredValue) {
        input.value = filteredValue;
        errorElement.textContent = 'Numbers are not allowed in names';
        errorElement.style.display = 'block';
        input.classList.add('border-red-500');
        input.classList.remove('border-gray-200');
        // Clear error after 3 seconds if input is now valid
        setTimeout(() => {
          if (errorElement && errorElement.textContent === 'Numbers are not allowed in names') {
            const currentValue = input.value;
            if (!/[0-9]/.test(currentValue) && /^[a-zA-Z\s'-]*$/.test(currentValue)) {
              errorElement.style.display = 'none';
              input.classList.remove('border-red-500');
              input.classList.add('border-gray-200');
            }
          }
        }, 3000);
      }
      
      // Now validate the filtered value
      return validateName(inputId, errorId);
    }

    // Name validation: only letters, spaces, hyphens, and apostrophes
    function validateName(inputId, errorId) {
      const input = document.getElementById(inputId);
      const errorElement = document.getElementById(errorId);
      const value = input.value.trim();
      
      // Pattern: letters, spaces, hyphens, apostrophes only
      const namePattern = /^[a-zA-Z\s'-]+$/;
      
      if (value === '') {
        errorElement.textContent = '';
        errorElement.style.display = 'none';
        input.classList.remove('border-red-500');
        input.classList.add('border-gray-200');
        return false;
      }
      
      // Check for numbers (shouldn't happen after filtering, but double-check)
      if (/[0-9]/.test(value)) {
        errorElement.textContent = 'Numbers are not allowed in names';
        errorElement.style.display = 'block';
        input.classList.remove('border-gray-200');
        input.classList.add('border-red-500');
        return false;
      }
      
      if (!namePattern.test(value)) {
        errorElement.textContent = 'Only letters, spaces, hyphens, and apostrophes are allowed';
        errorElement.style.display = 'block';
        input.classList.remove('border-gray-200');
        input.classList.add('border-red-500');
        return false;
      }
      
      if (value.length < 2) {
        errorElement.textContent = 'Name must be at least 2 characters';
        errorElement.style.display = 'block';
        input.classList.remove('border-gray-200');
        input.classList.add('border-red-500');
        return false;
      }
      
      if (value.length > 50) {
        errorElement.textContent = 'Name must be less than 50 characters';
        errorElement.style.display = 'block';
        input.classList.remove('border-gray-200');
        input.classList.add('border-red-500');
        return false;
      }
      
      errorElement.textContent = '';
      errorElement.style.display = 'none';
      input.classList.remove('border-red-500');
      input.classList.add('border-gray-200');
      return true;
    }

    // Student ID validation: exactly 6 digits (no letters allowed)
    function validateStudentId() {
      const input = document.getElementById('studentId');
      const errorElement = document.getElementById('studentIdError');
      const value = input.value.trim();
      
      // Check if there are any letters in the input
      const hasLetters = /[a-zA-Z]/.test(value);
      
      // Remove non-digits
      const digitsOnly = value.replace(/\D/g, '');
      
      // If letters were detected, show warning and remove them
      if (hasLetters) {
        input.value = digitsOnly;
        errorElement.textContent = 'Student ID must contain only numbers (0-9). Letters are not allowed.';
        errorElement.classList.remove('hidden');
        input.classList.remove('border-gray-200');
        input.classList.add('border-red-500');
        // Clear error after 3 seconds if user corrects
        setTimeout(() => {
          if (errorElement.textContent === 'Student ID must contain only numbers (0-9). Letters are not allowed.') {
            if (digitsOnly.length === 6) {
              errorElement.classList.add('hidden');
            }
          }
        }, 3000);
      }
      
      if (digitsOnly === '') {
        if (!hasLetters) {
          errorElement.textContent = '';
          errorElement.classList.add('hidden');
        }
        input.classList.remove('border-red-500');
        input.classList.add('border-gray-200');
        return false;
      }
      
      if (digitsOnly.length !== 6) {
        if (!hasLetters) {
          errorElement.textContent = 'Student ID must be exactly 6 digits';
          errorElement.classList.remove('hidden');
        }
        input.classList.remove('border-gray-200');
        input.classList.add('border-red-500');
        return false;
      }
      
      // Valid - exactly 6 digits, no letters
      errorElement.textContent = '';
      errorElement.classList.add('hidden');
      input.classList.remove('border-red-500');
      input.classList.add('border-gray-200');
      return true;
    }
    
    // Prevent letters from being typed in Student ID field
    function preventLettersInStudentId(event) {
      const char = String.fromCharCode(event.which || event.keyCode);
      // Allow: digits, backspace, delete, tab, escape, enter, arrow keys
      if (/[a-zA-Z]/.test(char)) {
        event.preventDefault();
        const input = event.target;
        const errorElement = document.getElementById('studentIdError');
        if (errorElement) {
          errorElement.textContent = 'Student ID must contain only numbers (0-9). Letters are not allowed.';
          errorElement.classList.remove('hidden');
          input.classList.add('border-red-500');
          input.classList.remove('border-gray-200');
          // Clear error after 3 seconds
          setTimeout(() => {
            if (errorElement.textContent === 'Student ID must contain only numbers (0-9). Letters are not allowed.') {
              if (input.value.length === 6 && /^\d{6}$/.test(input.value)) {
                errorElement.classList.add('hidden');
              }
            }
          }, 3000);
        }
        return false;
      }
      return true;
    }

    // Email validation (UMindanao format required - same as admin)
    function validateEmail() {
      const input = document.getElementById('email');
      const errorElement = document.getElementById('emailError');
      
      if (!input || !errorElement) {
        console.error('Email input or error element not found');
        return false;
      }
      
      const value = input.value.trim().toLowerCase();
      
      if (value === '') {
        errorElement.textContent = '';
        errorElement.style.display = 'none';
        input.classList.remove('border-red-500');
        input.classList.add('border-gray-200');
        return false;
      }
      
      // UMindanao email format: firstinitial.lastname.6digits.tc@umindanao.edu.ph
      // Example: j.delacruz.111222.tc@umindanao.edu.ph
      const umindanaoPattern = /^[a-z]\.[a-z]+\.\d{6}\.tc@umindanao\.edu\.ph$/i;
      
      if (!umindanaoPattern.test(value)) {
        // Check if it's a different domain (like proton.me)
        if (value.includes('@') && !value.includes('@umindanao.edu.ph')) {
          errorElement.textContent = 'Only UMindanao email addresses are allowed. Format: firstinitial.lastname.6digitid.tc@umindanao.edu.ph (e.g., j.delacruz.111222.tc@umindanao.edu.ph)';
        } else {
          errorElement.textContent = 'Email must follow format: firstinitial.lastname.6digitid.tc@umindanao.edu.ph (e.g., j.delacruz.111222.tc@umindanao.edu.ph)';
        }
        errorElement.style.display = 'block';
        errorElement.classList.remove('text-amber-600');
        errorElement.classList.add('text-red-600');
        input.classList.remove('border-gray-200', 'border-amber-300');
        input.classList.add('border-red-500');
        return false;
      }
      
      errorElement.textContent = '';
      errorElement.style.display = 'none';
      input.classList.remove('border-red-500', 'border-amber-300');
      input.classList.add('border-gray-200');
      return true;
    }

    // Password validation with strength check
    function validatePassword() {
      const input = document.getElementById('password');
      const errorElement = document.getElementById('passwordError');
      const value = input.value;
      
      if (value === '') {
        errorElement.textContent = '';
        errorElement.classList.add('hidden');
        input.classList.remove('border-red-500');
        input.classList.add('border-gray-200');
        return false;
      }
      
      if (value.length < 6) {
        errorElement.textContent = 'Password must be at least 6 characters';
        errorElement.classList.remove('hidden');
        input.classList.remove('border-gray-200');
        input.classList.add('border-red-500');
        return false;
      }
      
      if (value.length > 100) {
        errorElement.textContent = 'Password must be less than 100 characters';
        errorElement.classList.remove('hidden');
        input.classList.remove('border-gray-200');
        input.classList.add('border-red-500');
        return false;
      }
      
      // Password strength validation: at least one letter and one number
      if (!/(?=.*[a-zA-Z])(?=.*\d)/.test(value)) {
        errorElement.textContent = 'Password must contain at least one letter and one number';
        errorElement.classList.remove('hidden');
        input.classList.remove('border-gray-200');
        input.classList.add('border-red-500');
        return false;
      }
      
      // Trigger password match validation if confirm password has value
      const confirmPassword = document.getElementById('confirmPassword').value;
      if (confirmPassword) {
        validatePasswordMatch();
      }
      
      errorElement.textContent = '';
      errorElement.classList.add('hidden');
      input.classList.remove('border-red-500');
      input.classList.add('border-gray-200');
      return true;
    }

    // Password match validation
    function validatePasswordMatch() {
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirmPassword');
      const errorElement = document.getElementById('confirmPasswordError');
      const value = confirmPassword.value;
      
      if (value === '') {
        errorElement.textContent = '';
        errorElement.classList.add('hidden');
        confirmPassword.classList.remove('border-red-500');
        confirmPassword.classList.add('border-gray-200');
        return false;
      }
      
      if (value !== password) {
        errorElement.textContent = 'Passwords do not match';
        errorElement.classList.remove('hidden');
        confirmPassword.classList.remove('border-gray-200');
        confirmPassword.classList.add('border-red-500');
        return false;
      }
      
      errorElement.textContent = '';
      errorElement.classList.add('hidden');
      confirmPassword.classList.remove('border-red-500');
      confirmPassword.classList.add('border-gray-200');
      return true;
    }

    // Form submission validation
    document.getElementById('signupForm').addEventListener('submit', function(e) {
      const firstNameValid = validateName('firstName', 'firstNameError');
      const lastNameValid = validateName('lastName', 'lastNameError');
      const studentIdValid = validateStudentId();
      const emailValid = validateEmail();
      const passwordValid = validatePassword();
      const passwordMatchValid = validatePasswordMatch();
      
      // Validate club selection
      const clubSelect = document.getElementById('club_id');
      const clubError = document.getElementById('clubIdError');
      let clubValid = true;
      if (!clubSelect || !clubSelect.value || clubSelect.value === '') {
        clubValid = false;
        clubSelect.classList.add('border-red-500');
        if (clubError) {
          clubError.textContent = 'Please select a club/organization.';
          clubError.classList.remove('hidden');
        }
      } else {
        clubSelect.classList.remove('border-red-500');
        if (clubError) clubError.classList.add('hidden');
      }
      
      // Validate role selection
      const roleSelect = document.getElementById('role');
      const roleError = document.getElementById('roleError');
      let roleValid = true;
      if (!roleSelect || !roleSelect.value || roleSelect.value === '') {
        roleValid = false;
        roleSelect.classList.add('border-red-500');
        if (roleError) {
          roleError.textContent = 'Please select or enter your position/role.';
          roleError.classList.remove('hidden');
        }
      } else {
        const roleValue = roleSelect.value.trim();
        if (roleValue.length < 2) {
          roleValid = false;
          roleSelect.classList.add('border-red-500');
          if (roleError) {
            roleError.textContent = 'Position/Role must be at least 2 characters.';
            roleError.classList.remove('hidden');
          }
        } else if (roleValue.length > 100) {
          roleValid = false;
          roleSelect.classList.add('border-red-500');
          if (roleError) {
            roleError.textContent = 'Position/Role must be less than 100 characters.';
            roleError.classList.remove('hidden');
          }
        } else {
          roleSelect.classList.remove('border-red-500');
          if (roleError) roleError.classList.add('hidden');
        }
      }
      
      // Validate department
      const departmentSelect = document.getElementById('department');
      const departmentError = document.getElementById('departmentError');
      let departmentValid = true;
      if (!departmentSelect || !departmentSelect.value || departmentSelect.value === '') {
        departmentValid = false;
        departmentSelect.classList.add('border-red-500');
        if (departmentError) {
          departmentError.textContent = 'Please select your department.';
          departmentError.classList.remove('hidden');
        }
      } else {
        departmentSelect.classList.remove('border-red-500');
        if (departmentError) departmentError.classList.add('hidden');
      }
      
      // Validate program (required when department is selected)
      const programSelect = document.getElementById('programSelect');
      const programError = document.getElementById('programError');
      let programValid = true;
      
      // Only validate program if department is selected and program field is enabled
      if (departmentSelect && departmentSelect.value && !programSelect.disabled) {
        if (!programSelect || !programSelect.value || programSelect.value === '') {
          programValid = false;
          programSelect.classList.add('border-red-500');
          if (programError) {
            programError.textContent = 'Please select your program.';
            programError.classList.remove('hidden');
          }
        } else {
          programSelect.classList.remove('border-red-500');
          if (programError) programError.classList.add('hidden');
        }
      } else if (departmentSelect && departmentSelect.value) {
        // Department is selected but program not selected
        programValid = false;
        programSelect.classList.add('border-red-500');
        if (programError) {
          programError.textContent = 'Please select your program.';
          programError.classList.remove('hidden');
        }
      } else {
        // No department selected, program validation not needed yet
        programValid = true;
      }
      
      // Validate terms and conditions
      const termsCheckbox = document.getElementById('terms');
      const termsError = document.getElementById('termsError');
      let termsValid = true;
      if (!termsCheckbox || !termsCheckbox.checked) {
        termsValid = false;
        if (termsError) {
          termsError.textContent = 'You must accept the terms and conditions to continue.';
          termsError.classList.remove('hidden');
        }
      } else {
        if (termsError) termsError.classList.add('hidden');
      }
      
      if (!firstNameValid || !lastNameValid || !studentIdValid || !emailValid || !passwordValid || !passwordMatchValid || !clubValid || !roleValid || !departmentValid || !programValid || !termsValid) {
        e.preventDefault();
        
        // Find first error and scroll to it
        const firstError = document.querySelector('.border-red-500, #termsError:not(.hidden)') || document.querySelector('.border-red-500');
        if (firstError) {
          firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
          if (firstError.focus) firstError.focus();
        }
        
        return false;
      }
    });

    // Department/Program dropdown handled by external script
    // Terms and Conditions Modal
    function openTermsModal() {
      const modal = document.getElementById('termsModal');
      if (modal) {
        modal.classList.remove('hidden');
        document.body.style.overflow = 'hidden';
      }
    }

    function closeTermsModal() {
      const modal = document.getElementById('termsModal');
      if (modal) {
        modal.classList.add('hidden');
        document.body.style.overflow = '';
      }
    }

    // Close modal when clicking outside
    document.getElementById('termsModal')?.addEventListener('click', function(e) {
      if (e.target === this) {
        closeTermsModal();
      }
    });

    // Close modal on Escape key
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        const modal = document.getElementById('termsModal');
        if (modal && !modal.classList.contains('hidden')) {
          closeTermsModal();
        }
      }
    });
  </script>
  <script src="/js/departmentPrograms.js"></script>

  <!-- Terms and Conditions Modal -->
  <div id="termsModal" class="fixed inset-0 z-50 hidden flex items-center justify-center p-4" style="background: rgba(0, 0, 0, 0.75); backdrop-filter: blur(8px);">
    <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
      <div class="sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex items-center justify-between rounded-t-2xl">
        <h2 class="text-2xl font-bold text-gray-900">Terms and Conditions</h2>
        <button onclick="closeTermsModal()" class="text-gray-500 hover:text-gray-700 transition-colors">
          <i class="fas fa-times text-xl"></i>
        </button>
      </div>
      <div class="px-6 py-6 space-y-4">
        <ol class="space-y-4 text-gray-700">
          <li class="flex gap-3">
            <span class="font-bold text-brandRed">1.</span>
            <span>I understand that my account requires admin approval before I can access the system.</span>
          </li>
          <li class="flex gap-3">
            <span class="font-bold text-brandRed">2.</span>
            <span>I agree to provide accurate information and maintain the security of my account.</span>
          </li>
          <li class="flex gap-3">
            <span class="font-bold text-brandRed">3.</span>
            <span>I will use the system responsibly and in accordance with University policies.</span>
          </li>
          <li class="flex gap-3">
            <span class="font-bold text-brandRed">4.</span>
            <span>I understand that false information may result in account rejection or termination.</span>
          </li>
          <li class="flex gap-3">
            <span class="font-bold text-brandRed">5.</span>
            <span>I consent to the collection and use of my information for system administration purposes.</span>
          </li>
        </ol>
      </div>
      <div class="sticky bottom-0 bg-gray-50 border-t border-gray-200 px-6 py-4 flex justify-end rounded-b-2xl">
        <button onclick="closeTermsModal()" class="px-6 py-2 bg-brandRed text-white rounded-lg hover:bg-opacity-90 transition-colors font-semibold">
          I Understand
        </button>
      </div>
    </div>
  </div>
</body>
</html>

