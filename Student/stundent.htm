<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>UniClub - University Student Organizations</title>
    <link
      rel="icon"
      href="https://phshirt.com/wp-content/uploads/2022/01/UM-Tagum-College-1950.png"
      type="image/x-icon"
    />
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="main-style.css" />
  </head>

  <body class="min-h-screen gradient-bg">
    <!-- Login/Register Modal -->
    <div
      id="loginModal"
      class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 hidden"
    >
      <div class="bg-white rounded-2xl shadow-xl w-full max-w-md p-8 relative">
        <button
          onclick="closeLoginModal()"
          class="absolute top-4 right-4 text-gray-400 hover:text-gray-700"
        >
          <i class="fas fa-times"></i>
        </button>
        <h2 class="text-2xl font-bold mb-4 text-primary-600">
          Student Login / Register
        </h2>
        <form id="loginForm" class="space-y-4">
          <input
            type="text"
            id="studentId"
            class="w-full border rounded-lg px-4 py-2"
            placeholder="Student ID"
            required
          />
          <input
            type="text"
            id="studentName"
            class="w-full border rounded-lg px-4 py-2"
            placeholder="Full Name"
            required
          />
          <input
            type="text"
            id="studentCourse"
            class="w-full border rounded-lg px-4 py-2"
            placeholder="Course"
            required
          />
          <input
            type="number"
            id="studentYear"
            class="w-full border rounded-lg px-4 py-2"
            placeholder="Year Level"
            min="1"
            max="5"
            required
          />
          <button
            type="submit"
            class="w-full bg-primary-500 text-white rounded-lg py-2 font-semibold"
          >
            Login / Register
          </button>
        </form>
      </div>
    </div>

    <!-- Floating Background Elements -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
      <div
        class="absolute top-1/4 left-1/4 w-64 h-64 bg-white bg-opacity-5 rounded-full floating-element"
      ></div>
      <div
        class="absolute top-3/4 right-1/4 w-32 h-32 bg-primary-400 bg-opacity-10 rounded-full floating-element"
        style="animation-delay: 2s"
      ></div>
      <div
        class="absolute bottom-1/4 left-1/3 w-48 h-48 bg-accent-400 bg-opacity-8 rounded-full floating-element"
        style="animation-delay: 4s"
      ></div>
    </div>

    <!-- Navigation Header -->
    <nav class="relative z-50 glass-card">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
          <div class="flex items-center space-x-4">
            <div class="relative">
              <div
                class="w-10 h-10 bg-gradient-to-r from-primary-500 to-secondary-500 rounded-xl flex items-center justify-center"
              >
                <i class="fas fa-users text-white text-lg"></i>
              </div>
              <div
                class="absolute -top-1 -right-1 w-4 h-4 bg-accent-500 rounded-full pulse-ring"
              ></div>
            </div>
            <div>
              <h1 class="text-xl font-bold text-white">UniClub</h1>
              <p class="text-xs text-white/80">University of Mindanao</p>
            </div>
          </div>

          <div class="hidden md:flex items-center space-x-6">
            <a
              href="#"
              id="navDiscover"
              class="text-white/90 hover:text-white transition-colors font-medium"
              >Discover</a
            >
            <a
              href="#"
              id="navMyClubs"
              class="text-white/90 hover:text-white transition-colors font-medium"
              >My Clubs</a
            >
            <a
              href="#"
              id="navEvents"
              class="text-white/90 hover:text-white transition-colors font-medium"
              >Events</a
            >
          </div>

          <div class="flex items-center space-x-4">
            <div class="relative">
              <button
                id="notifBell"
                class="text-white/90 hover:text-white transition-colors relative"
              >
                <i class="fas fa-bell text-lg"></i>
                <span
                  id="notifCount"
                  class="absolute -top-2 -right-2 w-5 h-5 bg-accent-500 rounded-full flex items-center justify-center text-xs text-white font-bold"
                  >0</span
                >
              </button>
              <div
                id="notifDropdown"
                class="hidden absolute right-0 mt-2 w-72 bg-white rounded-xl shadow-lg z-50 py-2"
              >
                <div class="px-4 py-2 font-semibold text-primary-600 border-b">
                  Notifications
                </div>
                <ul id="notifList" class="max-h-60 overflow-y-auto"></ul>
                <div class="px-4 py-2 text-xs text-gray-400 border-t">
                  Club join requests and approvals will appear here.
                </div>
              </div>
            </div>
            <!-- Student Profile -->
            <div class="relative">
              <div class="profile cursor-pointer" id="topProfile">
                <img src="https://i.pravatar.cc/50" alt="Profile" />
                <span>Student</span>
              </div>
              <!-- Profile quick panel -->
              <div
                id="profilePanel"
                style="
                  display: none;
                  position: absolute;
                  right: 0;
                  top: 72px;
                  background: #fff;
                  border: 1px solid #e5e7eb;
                  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
                  border-radius: 10px;
                  z-index: 2000;
                  min-width: 260px;
                  padding: 12px;
                "
              >
                <button class="close-small" id="profileCloseBtn" title="Close">
                  ✖
                </button>
                <div
                  style="
                    display: flex;
                    gap: 12px;
                    align-items: center;
                    padding: 8px;
                  "
                >
                  <img
                    src="https://i.pravatar.cc/64"
                    alt="Profile"
                    style="width: 48px; height: 48px; border-radius: 50%"
                  />
                  <div>
                    <div style="font-weight: 700; color: #2563eb">Student</div>
                    <div style="font-size: 13px; color: #666">
                      Role: Student Member
                    </div>
                    <div style="font-size: 13px; color: #666">
                      student@example.com
                    </div>
                  </div>
                </div>
                <div
                  style="
                    border-top: 1px solid #f0f0f0;
                    margin-top: 8px;
                    padding-top: 8px;
                    display: flex;
                    gap: 8px;
                    justify-content: space-between;
                  "
                >
                  <button class="btn btn-light" id="editProfileBtn">
                    Edit Profile
                  </button>
                  <button class="btn" id="logoutBtn">Logout</button>
                </div>
                <div
                  style="
                    margin-top: 10px;
                    display: flex;
                    flex-direction: column;
                    gap: 8px;
                  "
                >
                  <div style="display: flex; gap: 8px; align-items: center">
                    <a
                      id="emailBtn"
                      class="btn"
                      href="mailto:student@example.com"
                      style="
                        display: inline-flex;
                        align-items: center;
                        gap: 8px;
                      "
                    >
                      <span>Email</span>
                      <button
                        id="emailCopyBtn"
                        type="button"
                        title="Copy email"
                        aria-label="Copy email"
                        style="
                          border: none;
                          background: transparent;
                          padding: 4px;
                          display: inline-flex;
                          align-items: center;
                          justify-content: center;
                          border-radius: 4px;
                          cursor: pointer;
                        "
                      >
                        <i class="fas fa-copy" style="font-size: 12px"></i>
                      </button>
                    </a>
                  </div>
                  <div style="display: flex; gap: 8px; align-items: center">
                    <button
                      id="changePasswordBtn"
                      class="btn btn-light"
                      style="
                        display: inline-flex;
                        align-items: center;
                        gap: 8px;
                        width: 100%;
                        justify-content: center;
                      "
                    >
                      <i class="fas fa-key" style="font-size: 12px"></i>
                      <span>Change Password</span>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <div class="relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
      <!-- Hero Section -->
      <div class="text-center mb-16 slide-in">
        <div
          class="inline-flex items-center bg-white/10 backdrop-blur-sm rounded-full px-6 py-2 mb-6"
        >
          <i class="fas fa-star text-accent-400 mr-2"></i>
          <span class="text-white font-medium"
            >Join 2,500+ Active Students</span
          >
        </div>

        <h1
          class="text-5xl md:text-7xl font-bold text-white mb-6 tracking-tight"
        >
          Discover, Connect, Belong.
        </h1>
        <p class="text-xl text-white/90 mb-8 max-w-2xl mx-auto leading-relaxed">
          Connect with like-minded students, join amazing clubs, and create
          unforgettable university experiences through UniClub.
        </p>

        <!-- Search Bar -->
        <div class="max-w-2xl mx-auto mb-8">
          <div class="relative">
            <div
              class="absolute inset-y-0 left-0 pl-6 flex items-center pointer-events-none"
            >
              <i class="fas fa-search text-gray-400 text-xl"></i>
            </div>
            <input
              type="text"
              id="clubSearch"
              class="w-full pl-16 pr-6 py-4 bg-white/95 backdrop-blur-sm rounded-2xl text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-4 focus:ring-primary-500/30 text-lg"
              placeholder="Search for clubs, activities, or interests..."
            />
            <button
              class="absolute right-2 top-2 bottom-2 px-6 bg-gradient-to-r from-primary-500 to-primary-600 rounded-xl text-white font-semibold hover:from-primary-600 hover:to-primary-700 transition-all"
            >
              <i class="fas fa-arrow-right"></i>
            </button>
          </div>
        </div>

        <!-- Quick Stats -->
        <div
          class="flex justify-center items-center space-x-8 text-white/90 mb-12"
        >
          <div class="text-center">
            <div class="text-2xl font-bold text-white">150+</div>
            <div class="text-sm">Active Clubs</div>
          </div>
          <div class="w-px h-12 bg-white/20"></div>
          <div class="text-center">
            <div class="text-2xl font-bold text-white">500+</div>
            <div class="text-sm">Events/Month</div>
          </div>
          <div class="w-px h-12 bg-white/20"></div>
          <div class="text-center">
            <div class="text-2xl font-bold text-white">95%</div>
            <div class="text-sm">Satisfaction</div>
          </div>
        </div>
      </div>

      <!-- Category Filters -->
      <div
        class="flex flex-wrap justify-center gap-3 mb-12"
        id="categoryFilters"
      >
        <button
          class="category-filter px-6 py-3 bg-white/10 backdrop-blur-sm rounded-full text-white font-medium transition-all hover:bg-white/20 active"
          data-category="all"
        >
          <i class="fas fa-th-large mr-2"></i>All Clubs
        </button>
        <button
          class="category-filter px-6 py-3 bg-white/10 backdrop-blur-sm rounded-full text-white font-medium transition-all hover:bg-white/20"
          data-category="academic"
        >
          <i class="fas fa-graduation-cap mr-2"></i>Academic
        </button>
        <button
          class="category-filter px-6 py-3 bg-white/10 backdrop-blur-sm rounded-full text-white font-medium transition-all hover:bg-white/20"
          data-category="sports"
        >
          <i class="fas fa-dumbbell mr-2"></i>Sports & Fitness
        </button>
        <button
          class="category-filter px-6 py-3 bg-white/10 backdrop-blur-sm rounded-full text-white font-medium transition-all hover:bg-white/20"
          data-category="arts"
        >
          <i class="fas fa-palette mr-2"></i>Arts & Culture
        </button>
        <button
          class="category-filter px-6 py-3 bg-white/10 backdrop-blur-sm rounded-full text-white font-medium transition-all hover:bg-white/20"
          data-category="tech"
        >
          <i class="fas fa-code mr-2"></i>Technology
        </button>
        <button
          class="category-filter px-6 py-3 bg-white/10 backdrop-blur-sm rounded-full text-white font-medium transition-all hover:bg-white/20"
          data-category="service"
        >
          <i class="fas fa-heart mr-2"></i>Community Service
        </button>
      </div>

      <!-- Featured Clubs Grid -->
      <div
        id="clubsGrid"
        class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 mb-16"
      >
        <!-- Clubs will be dynamically inserted here -->
      </div>

      <!-- Club Details Modal -->
      <div
        id="clubDetailsModal"
        class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 hidden"
      >
        <div
          class="bg-white rounded-2xl shadow-xl w-full max-w-2xl p-8 relative"
        >
          <button
            onclick="closeClubDetailsModal()"
            class="absolute top-4 right-4 text-gray-400 hover:text-gray-700"
          >
            <i class="fas fa-times"></i>
          </button>
          <div id="clubDetailsContent">
            <!-- Club details will be injected here -->
          </div>
        </div>
      </div>

      <!-- Notification Area -->
      <div
        id="notificationArea"
        class="fixed top-6 right-6 z-50 space-y-2"
      ></div>

      <!-- Change Password Modal -->
      <div
        class="modal"
        id="changePasswordModal"
        style="
          display: none;
          align-items: center;
          justify-content: center;
          z-index: 1000;
        "
      >
        <div
          class="modal-content modal-card"
          style="max-width: 500px; width: 94%"
        >
          <div class="modal-header">
            <h3 style="color: #a83232">Change Password</h3>
            <button
              class="close-btn"
              onclick="document.getElementById('changePasswordModal').style.display='none'"
            >
              ✖
            </button>
          </div>
          <div class="modal-body">
            <form id="changePasswordForm">
              <div class="form-group">
                <label for="currentPassword">Current Password</label>
                <input
                  id="currentPassword"
                  type="password"
                  required
                  placeholder="Enter your current password"
                />
              </div>
              <div class="form-group">
                <label for="newPassword">New Password</label>
                <input
                  id="newPassword"
                  type="password"
                  required
                  placeholder="Enter your new password"
                  minlength="6"
                />
              </div>
              <div class="form-group">
                <label for="confirmPassword">Confirm New Password</label>
                <input
                  id="confirmPassword"
                  type="password"
                  required
                  placeholder="Confirm your new password"
                  minlength="6"
                />
              </div>
              <div class="form-group">
                <label
                  style="
                    display: flex;
                    align-items: center;
                    gap: 8px;
                    font-weight: normal;
                  "
                >
                  <input type="checkbox" id="showPasswords" style="margin: 0" />
                  Show passwords
                </label>
              </div>
              <div class="form-actions">
                <button
                  type="button"
                  class="btn btn-light"
                  onclick="closeChangePasswordModal()"
                >
                  Cancel
                </button>
                <button type="submit" class="btn">Change</button>
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Edit Profile Modal -->
      <div
        class="modal"
        id="editProfileModal"
        style="
          display: none;
          align-items: center;
          justify-content: center;
          z-index: 1000;
        "
      >
        <div
          class="modal-content modal-card"
          style="max-width: 620px; width: 94%"
        >
          <div class="modal-header">
            <h3>Edit Profile</h3>
            <button
              class="close-btn"
              onclick="document.getElementById('editProfileModal').style.display='none'"
            >
              ✖
            </button>
          </div>
          <div
            class="modal-body"
            style="
              display: flex;
              gap: 18px;
              flex-direction: row;
              align-items: flex-start;
            "
          >
            <div
              style="
                min-width: 140px;
                display: flex;
                flex-direction: column;
                gap: 12px;
                align-items: center;
              "
            >
              <div
                class="avatar-preview"
                id="edit-avatar-display"
                style="
                  width: 120px;
                  height: 120px;
                  border-radius: 12px;
                  overflow: hidden;
                  background: #f3f3f3;
                  display: flex;
                  align-items: center;
                  justify-content: center;
                "
              >
                <img
                  src="https://i.pravatar.cc/128?u=student"
                  alt="avatar"
                  id="editAvatarImg"
                  style="width: 100%; height: 100%; object-fit: cover"
                />
              </div>
              <input
                type="file"
                id="ep-avatar-file"
                accept="image/*"
                style="display: none"
              />
              <button
                type="button"
                class="btn btn-light"
                id="uploadAvatarBtn"
                onclick="document.getElementById('ep-avatar-file').click()"
              >
                Upload Avatar
              </button>
              <small class="muted">Square images work best</small>
            </div>
            <div style="flex: 1">
              <form id="editProfileForm">
                <div class="form-group">
                  <label for="ep-name">Name</label>
                  <input id="ep-name" type="text" required />
                </div>
                <div class="form-group">
                  <label for="ep-role">Role</label>
                  <input id="ep-role" type="text" />
                </div>
                <div class="form-group">
                  <label for="ep-email">Email</label>
                  <input id="ep-email" type="email" />
                </div>
                <div class="form-group">
                  <label for="ep-student-id">Student ID</label>
                  <input id="ep-student-id" type="text" />
                </div>
                <div class="form-group">
                  <label for="ep-course">Course</label>
                  <input id="ep-course" type="text" />
                </div>
                <div class="form-group">
                  <label for="ep-year">Year Level</label>
                  <select id="ep-year">
                    <option value="1">1st Year</option>
                    <option value="2">2nd Year</option>
                    <option value="3">3rd Year</option>
                    <option value="4">4th Year</option>
                    <option value="5">5th Year</option>
                  </select>
                </div>
                <div class="form-actions">
                  <button
                    type="button"
                    class="btn btn-light"
                    onclick="closeEditProfileModal()"
                  >
                    Cancel
                  </button>
                  <button type="submit" class="btn">Save Changes</button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>

      <!-- Member Dashboard Section -->
      <div id="memberDashboard" class="hidden mt-12">
        <div class="glass-card rounded-3xl p-8 mb-8">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-2xl font-bold text-primary-600 flex items-center">
              <i class="fas fa-user-friends mr-3 text-accent-400"></i> My Clubs
            </h2>
            <button
              id="viewAllJoinedClubsBtn"
              class="bg-primary-500 text-white px-5 py-2 rounded-lg font-semibold hover:bg-primary-600 transition-all"
              onclick="window.location.href='MyClub.htm'"
            >
              View All Joined Clubs
            </button>
          </div>
          <div id="myClubsList" class="mb-8"></div>
          <!-- Modal for All Joined Clubs -->
          <div
            id="allJoinedClubsModal"
            class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 hidden"
          >
            <div
              class="bg-white rounded-2xl shadow-xl w-full max-w-lg p-8 relative"
            >
              <button
                onclick="closeAllJoinedClubsModal()"
                class="absolute top-4 right-4 text-gray-400 hover:text-gray-700"
              >
                <i class="fas fa-times"></i>
              </button>
              <h2
                class="text-xl font-bold mb-4 text-primary-600 flex items-center"
              >
                <i class="fas fa-users mr-2"></i> All Joined Clubs
              </h2>
              <div id="allJoinedClubsList"></div>
            </div>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div>
              <h3 class="font-semibold text-lg mb-2">Announcements</h3>
              <ul id="memberAnnouncements" class="space-y-2"></ul>
            </div>
            <div>
              <h3 class="font-semibold text-lg mb-2">Upcoming Events</h3>
              <ul id="memberEvents" class="space-y-2"></ul>
            </div>
            <div>
              <h3 class="font-semibold text-lg mb-2">Tasks</h3>
              <ul id="memberTasks" class="space-y-2"></ul>
            </div>
            <div>
              <h3 class="font-semibold text-lg mb-2">Attendance</h3>
              <ul id="memberAttendance" class="space-y-2"></ul>
            </div>
          </div>
          <div class="mt-8 flex gap-4">
            <button
              class="bg-red-500 text-white px-6 py-2 rounded-lg font-semibold"
              onclick="leaveClub()"
            >
              Leave Club
            </button>
            <button
              class="bg-primary-500 text-white px-6 py-2 rounded-lg font-semibold"
              onclick="openEditProfileModal()"
            >
              Update Profile
            </button>
          </div>
        </div>
      </div>

      <!-- Upcoming Events Section -->
      <div class="glass-card rounded-3xl p-8 mb-16">
        <div class="flex items-center justify-between mb-8">
          <h2 class="text-3xl font-bold text-white">
            <i class="fas fa-calendar-alt mr-3 text-accent-400"></i>
            Upcoming Events
          </h2>
          <button
            class="bg-white/20 backdrop-blur-sm px-6 py-2 rounded-full text-white font-medium hover:bg-white/30 transition-all"
          >
            View All Events
          </button>
        </div>

        <div
          class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"
          id="eventsGrid"
        >
          <!-- Events will be dynamically inserted here -->
        </div>
      </div>
    </div>

    <script src="../Javascript/Main-Script.js"></script>
    <script>
      function openAllJoinedClubsModal() {
        document
          .getElementById("allJoinedClubsModal")
          .classList.remove("hidden");
        renderAllJoinedClubsList();
      }
      function closeAllJoinedClubsModal() {
        document.getElementById("allJoinedClubsModal").classList.add("hidden");
      }
      function renderAllJoinedClubsList() {
        const myClubs = window.clubsData
          ? window.clubsData.filter((c) => c.isJoined)
          : [];
        const listDiv = document.getElementById("allJoinedClubsList");
        if (!myClubs.length) {
          listDiv.innerHTML =
            '<div class="text-gray-500">You have not joined any clubs yet.</div>';
          return;
        }
        listDiv.innerHTML = myClubs
          .map(
            (club) => `
          <div class="flex items-center gap-4 mb-4 p-4 bg-primary-50 rounded-xl">
            <span class="text-3xl">${club.image}</span>
            <div>
              <div class="font-bold text-lg text-primary-700">${club.name}</div>
              <div class="text-sm text-gray-700">${club.description}</div>
            </div>
          </div>
        `
          )
          .join("");
      }
    </script>
    <script>
      // Notification dropdown logic
      const notifBell = document.getElementById("notifBell");
      const notifDropdown = document.getElementById("notifDropdown");
      notifBell.addEventListener("click", function (e) {
        e.stopPropagation();
        notifDropdown.classList.toggle("hidden");
      });
      document.addEventListener("click", function (e) {
        if (!notifBell.contains(e.target)) {
          notifDropdown.classList.add("hidden");
        }
      });
      // Nav logic
      document
        .getElementById("navMyClubs")
        .addEventListener("click", function (e) {
          e.preventDefault();
          // Navigate to MyClub.htm
          window.location.href = "MyClub.htm";
        });
      document
        .getElementById("navDiscover")
        .addEventListener("click", function (e) {
          e.preventDefault();
          hideMemberDashboard();
        });
      // Render joined clubs in dashboard
      function renderMyClubsList() {
        const myClubs = window.clubsData
          ? window.clubsData.filter((c) => c.isJoined)
          : [];
        const listDiv = document.getElementById("myClubsList");
        if (!myClubs.length) {
          listDiv.innerHTML =
            '<div class="text-gray-500">You have not joined any clubs yet.</div>';
          return;
        }
        listDiv.innerHTML = myClubs
          .map(
            (club) => `
          <div class="flex items-center gap-4 mb-4 p-4 bg-white/10 rounded-xl">
            <span class="text-3xl">${club.image}</span>
            <div>
              <div class="font-bold text-lg text-white">${club.name}</div>
              <div class="text-sm text-white/70">${club.description}</div>
            </div>
          </div>
        `
          )
          .join("");
      }
      // Notification system for joined clubs
      function updateClubNotifications() {
        const myClubs = window.clubsData
          ? window.clubsData.filter((c) => c.isJoined)
          : [];
        const notifCount = document.getElementById("notifCount");
        const notifList = document.getElementById("notifList");
        notifCount.textContent = myClubs.length;
        notifList.innerHTML = myClubs.length
          ? myClubs
              .map(
                (club) =>
                  `<li class='px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded'>You are now a member of <b>${club.name}</b>!</li>`
              )
              .join("")
          : '<li class="px-4 py-2 text-sm text-gray-400">No notifications</li>';
      }
      // Patch joinClub to update notifications and dashboard
      const origJoinClub = window.joinClub;
      window.joinClub = function (clubId) {
        origJoinClub(clubId);
        updateClubNotifications();
        renderMyClubsList();
      };
      // On load, update notifications
      document.addEventListener("DOMContentLoaded", function () {
        updateClubNotifications();
      });
    </script>
    <script>
      // Modal and dashboard logic (basic hooks)
      function openLoginModal() {
        document.getElementById("loginModal").classList.remove("hidden");
      }
      function closeLoginModal() {
        document.getElementById("loginModal").classList.add("hidden");
      }
      function openClubDetailsModal() {
        document.getElementById("clubDetailsModal").classList.remove("hidden");
      }
      function closeClubDetailsModal() {
        document.getElementById("clubDetailsModal").classList.add("hidden");
      }
      function showNotification(msg, type = "success") {
        const area = document.getElementById("notificationArea");
        const div = document.createElement("div");
        div.className = `px-4 py-2 rounded-lg shadow-lg text-white font-semibold ${
          type === "success" ? "bg-green-500" : "bg-red-500"
        }`;
        div.innerText = msg;
        area.appendChild(div);
        setTimeout(() => div.remove(), 3500);
      }
      function showMemberDashboard() {
        document.getElementById("memberDashboard").classList.remove("hidden");
      }
      function hideMemberDashboard() {
        document.getElementById("memberDashboard").classList.add("hidden");
      }
      function leaveClub() {
        showNotification("You have left the club.", "success");
        hideMemberDashboard();
      }
      function openProfileModal() {
        showNotification("Profile update coming soon!", "success");
      }
      // Example: Open login modal on page load if not logged in
      // openLoginModal();

      // Profile panel logic - initialize after DOM is ready
      document.addEventListener("DOMContentLoaded", function () {
        // Profile data helpers
        function loadProfileFromStorage() {
          try {
            const p = JSON.parse(localStorage.getItem("userProfile"));
            if (p && typeof p === "object") {
              return {
                name: p.name || "Student",
                role: p.role || "Student Member",
                email: p.email || "student@example.com",
                studentId: p.studentId || "",
                course: p.course || "",
                year: p.year || "1",
                avatar: p.avatar || "https://i.pravatar.cc/50?u=student",
              };
            }
          } catch (e) {
            console.warn("Failed to load profile from storage:", e);
          }
          return {
            name: "Student",
            role: "Student Member",
            email: "student@example.com",
            studentId: "",
            course: "",
            year: "1",
            avatar: "https://i.pravatar.cc/50?u=student",
          };
        }

        function setProfile(profile) {
          try {
            localStorage.setItem("userProfile", JSON.stringify(profile));
          } catch (e) {
            console.warn("Failed to save profile to storage:", e);
          }

          // Update UI elements
          const topProfileImg = document.querySelector("#topProfile img");
          const topProfileName = document.querySelector("#topProfile span");
          if (topProfileImg)
            topProfileImg.src = profile.avatar || topProfileImg.src;
          if (topProfileName)
            topProfileName.textContent =
              profile.name || topProfileName.textContent;

          // Update profile panel
          const profilePanel = document.getElementById("profilePanel");
          if (profilePanel) {
            const infoDivs = profilePanel.querySelectorAll("div > div > div");
            if (infoDivs[0]) infoDivs[0].textContent = profile.name;
            if (infoDivs[1])
              infoDivs[1].textContent = "Role: " + (profile.role || "");
            if (infoDivs[2]) infoDivs[2].textContent = profile.email || "";

            const panelImg = profilePanel.querySelector("img");
            if (panelImg) panelImg.src = profile.avatar || panelImg.src;
          }
        }

        function getProfile() {
          try {
            return (
              JSON.parse(localStorage.getItem("userProfile")) ||
              loadProfileFromStorage()
            );
          } catch (e) {
            return loadProfileFromStorage();
          }
        }

        // Profile panel functions
        function showProfile() {
          const profilePanel = document.getElementById("profilePanel");
          if (profilePanel) {
            profilePanel.style.display = "block";
            setTimeout(() => {
              profilePanel.classList.add("show");
            }, 10);
          }
        }

        function hideProfile() {
          const profilePanel = document.getElementById("profilePanel");
          if (profilePanel) {
            profilePanel.classList.remove("show");
            setTimeout(() => {
              profilePanel.style.display = "none";
            }, 200);
          }
        }

        // Edit profile modal handlers
        function openEditProfileModal() {
          const modal = document.getElementById("editProfileModal");
          const profile = getProfile();

          if (modal) {
            // Close profile panel when opening modal
            hideProfile();

            document.getElementById("ep-name").value = profile.name || "";
            document.getElementById("ep-role").value = profile.role || "";
            document.getElementById("ep-email").value = profile.email || "";
            document.getElementById("ep-student-id").value =
              profile.studentId || "";
            document.getElementById("ep-course").value = profile.course || "";
            document.getElementById("ep-year").value = profile.year || "1";

            modal.style.display = "flex";
          }
        }

        function closeEditProfileModal() {
          const modal = document.getElementById("editProfileModal");
          if (modal) {
            modal.style.display = "none";
          }
        }

        // Change Password modal handlers
        function openChangePasswordModal() {
          const modal = document.getElementById("changePasswordModal");
          if (modal) {
            // Close profile panel when opening modal
            hideProfile();

            // Clear form fields
            document.getElementById("currentPassword").value = "";
            document.getElementById("newPassword").value = "";
            document.getElementById("confirmPassword").value = "";
            document.getElementById("showPasswords").checked = false;

            modal.style.display = "flex";
          }
        }

        function closeChangePasswordModal() {
          const modal = document.getElementById("changePasswordModal");
          if (modal) {
            modal.style.display = "none";
          }
        }

        // Initialize profile functionality
        function initProfileModule() {
          const topProfile = document.getElementById("topProfile");
          const profilePanel = document.getElementById("profilePanel");

          if (!topProfile || !profilePanel) {
            console.warn("Profile elements not found");
            return;
          }

          // Profile click handler
          topProfile.addEventListener("click", function (e) {
            e.stopPropagation();
            if (
              profilePanel.style.display === "none" ||
              !profilePanel.style.display
            ) {
              showProfile();
            } else {
              hideProfile();
            }
          });

          // Close profile panel when clicking outside
          document.addEventListener("click", function (e) {
            if (
              !profilePanel.contains(e.target) &&
              !topProfile.contains(e.target)
            ) {
              hideProfile();
            }
          });

          // Wire edit profile button
          const editProfileBtn = document.getElementById("editProfileBtn");
          if (editProfileBtn) {
            editProfileBtn.addEventListener("click", openEditProfileModal);
          }

          // Wire change password button
          const changePasswordBtn =
            document.getElementById("changePasswordBtn");
          if (changePasswordBtn) {
            changePasswordBtn.addEventListener(
              "click",
              openChangePasswordModal
            );
          }

          // Email copy functionality
          const emailCopyBtn = document.getElementById("emailCopyBtn");
          if (emailCopyBtn) {
            emailCopyBtn.addEventListener("click", function (e) {
              e.preventDefault();
              const profile = getProfile();
              if (navigator.clipboard && profile && profile.email) {
                navigator.clipboard
                  .writeText(profile.email)
                  .then(() => {
                    showNotification("Email copied to clipboard!", "success");
                  })
                  .catch(() => {
                    showNotification("Failed to copy email", "error");
                  });
              }
            });
          }

          // Update mailto link when profile changes
          const emailBtn = document.getElementById("emailBtn");
          if (emailBtn) {
            const profile = getProfile();
            if (emailBtn && profile && profile.email) {
              emailBtn.href = "mailto:" + profile.email;
            }
          }

          // Logout functionality
          const logoutBtn = document.getElementById("logoutBtn");
          if (logoutBtn) {
            logoutBtn.addEventListener("click", function () {
              if (confirm("Are you sure you want to logout?")) {
                try {
                  // Clear all session data
                  localStorage.removeItem("userProfile");
                  localStorage.removeItem("isLoggedIn");
                  localStorage.removeItem("userRole");
                  localStorage.removeItem("userUMTCId");
                  localStorage.removeItem("userName");
                  localStorage.removeItem("loginTime");
                  localStorage.removeItem("rememberUMTC");
                  localStorage.removeItem("rememberUMTCId");
                  localStorage.removeItem("rememberRole");
                } catch (e) {
                  console.warn("Failed to clear session data:", e);
                }
                
                // Redirect to login page
                window.location.href = "../Login/login.htm";
              }
            });
          }

          // Wire profile close button
          const profileCloseBtn = document.getElementById("profileCloseBtn");
          if (profileCloseBtn) {
            profileCloseBtn.addEventListener("click", hideProfile);
          }

          // Initialize profile UI from storage
          setTimeout(() => {
            setProfile(loadProfileFromStorage());
          }, 100);

          console.log("Profile module initialized successfully");
        }

        // Handle edit profile form submit
        const editProfileForm = document.getElementById("editProfileForm");
        if (editProfileForm) {
          editProfileForm.addEventListener("submit", function (e) {
            e.preventDefault();
            const current = getProfile();
            const newProfile = {
              name: document.getElementById("ep-name").value,
              role: document.getElementById("ep-role").value,
              email: document.getElementById("ep-email").value,
              studentId: document.getElementById("ep-student-id").value,
              course: document.getElementById("ep-course").value,
              year: document.getElementById("ep-year").value,
              avatar: current.avatar, // Keep existing avatar for now
            };

            setProfile(newProfile);
            closeEditProfileModal();
            showNotification("Profile updated successfully!", "success");
          });
        }

        // Handle change password form submit
        const changePasswordForm =
          document.getElementById("changePasswordForm");
        if (changePasswordForm) {
          changePasswordForm.addEventListener("submit", function (e) {
            e.preventDefault();

            const currentPassword =
              document.getElementById("currentPassword").value;
            const newPassword = document.getElementById("newPassword").value;
            const confirmPassword =
              document.getElementById("confirmPassword").value;

            // Validation
            if (!currentPassword) {
              showNotification("Please enter your current password", "error");
              return;
            }

            if (newPassword.length < 6) {
              showNotification(
                "New password must be at least 6 characters long",
                "error"
              );
              return;
            }

            if (newPassword !== confirmPassword) {
              showNotification("New passwords do not match", "error");
              return;
            }

            if (currentPassword === newPassword) {
              showNotification(
                "New password must be different from current password",
                "error"
              );
              return;
            }

            // Simulate password change (in real app, this would call an API)
            try {
              // Store the new password (in real app, this would be hashed)
              const profile = getProfile();
              profile.password = newPassword; // This is just for demo - never store plain text passwords!
              setProfile(profile);

              closeChangePasswordModal();
              showNotification("Password changed successfully!", "success");
            } catch (error) {
              showNotification(
                "Failed to change password. Please try again.",
                "error"
              );
            }
          });
        }

        // Handle show passwords checkbox
        const showPasswordsCheckbox = document.getElementById("showPasswords");
        if (showPasswordsCheckbox) {
          showPasswordsCheckbox.addEventListener("change", function () {
            const passwordFields = [
              document.getElementById("currentPassword"),
              document.getElementById("newPassword"),
              document.getElementById("confirmPassword"),
            ];

            passwordFields.forEach((field) => {
              if (field) {
                field.type = this.checked ? "text" : "password";
              }
            });
          });
        }

        // Expose profile helpers on window for console / external use
        window.getProfile = getProfile;
        window.setProfile = setProfile;
        window.openEditProfileModal = openEditProfileModal;
        window.openChangePasswordModal = openChangePasswordModal;
        window.closeChangePasswordModal = closeChangePasswordModal;
        window.showProfile = showProfile;
        window.hideProfile = hideProfile;

        window.openProfile = function (opts = { show: true }) {
          const profile = getProfile();
          if (opts.show) showProfile();
          return profile;
        };

        // Initialize profile module
        initProfileModule();

        console.log(
          "Profile helpers exposed: getProfile, setProfile, openEditProfileModal, openChangePasswordModal, showProfile, hideProfile"
        );
      });
    </script>
  </body>
</html>
